<template>
    <i-row>
        <i-col span="12">
            <i-form :label-width="200" method="post">
                <i-form-item label="MySQL table">
                    <i-auto-complete :data="table_list" v-model="table_name"
                                     placeholder="Click to choose MySQL table"></i-auto-complete>
                </i-form-item>
                <i-form-item>
                    <i-button type="primary" @click="preview">Preview</i-button>
                    <i-button type="success" @click="generate">Generate</i-button>
                </i-form-item>
            </i-form>
            <i-alert type="" show-icon>
                <span slot="desc"></span>
            </i-alert>
        </i-col>
    </i-row>
</template>
<script type="text/javascript">
    module.exports = {
        data: function() {
            return {
                table_list: [],
                table_name:''
            }
        },
        methods: {
            getTableList: function() {
                let that = this

                this.axios
                    .post('/sword/api/model/table_list')
                    .then(response => {
                        if (response.data.code == 200) {
                            that.table_list = response.data.data.list
                        }else {
                            alert(response.data.msg)
                        }
                    })
            },
            preview:function() {
                let that = this
                this.axios
                    .post('/sword/api/model/preview',{table_name:this.table_name})
                    .then(response => {
                        if (response.data.code == 200) {
                            console.info(response.data)
                        }else {
                            alert(response.data.msg)
                        }
                    })
            },
            generate:function() {
                let that = this
                this.axios
                    .post('/sword/api/model/generate',{table_name:this.table_name})
                    .then(response => {
                        if (response.data.code == 200) {
                            console.info(response.data)
                        }else {
                            alert(response.data.msg)
                        }
                    })
            }
        },
        mounted: function() {
            this.getTableList()
        }
    }
</script>